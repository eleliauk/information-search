# 实现计划

- [x] 1. 设置项目结构和核心数据模型
  - 创建 lesson2 目录结构（src, tests, data, config）
  - 定义 Document、Posting、IndexStatistics、BooleanQuery 数据类
  - 设置 pytest 和 hypothesis 测试框架
  - 创建 requirements.txt 文件
  - _需求：1.1, 1.2_

- [x] 2. 实现文档存储组件
  - 实现 DocumentStore 类的基本结构
  - 实现 add_document 方法，包含文档ID自动分配
  - 实现 get_document 和 get_all_documents 方法
  - 实现文档验证逻辑（拒绝空文档）
  - 实现 document_count 方法
  - _需求：1.1, 1.2, 1.3, 1.4_

- [ ]* 2.1 编写 DocumentStore 的属性测试
  - **属性 1：文档ID唯一性**
  - **验证需求：1.1**

- [ ]* 2.2 编写 DocumentStore 的属性测试
  - **属性 2：文档内容完整性**
  - **验证需求：1.2, 1.3**

- [x] 3. 实现文本预处理组件
  - 实现 TextPreprocessor 类的基本结构
  - 集成 jieba 分词库
  - 实现停用词加载和过滤功能
  - 实现文本规范化（小写转换、标点处理）
  - 实现 tokenize 方法，返回处理后的词项列表
  - _需求：2.1, 2.2, 2.3, 2.4_

- [ ]* 3.1 编写 TextPreprocessor 的属性测试
  - **属性 3：停用词过滤**
  - **验证需求：2.2**

- [ ]* 3.2 编写 TextPreprocessor 的属性测试
  - **属性 4：大小写规范化**
  - **验证需求：2.3**

- [ ]* 3.3 编写 TextPreprocessor 的属性测试
  - **属性 5：标点符号处理**
  - **验证需求：2.4**

- [x] 4. 实现倒排索引核心组件
  - 实现 InvertedIndex 类的基本结构
  - 实现倒排索引数据结构（Dict[str, List[Posting]]）
  - 实现 build_index 方法，构建词项到文档的映射
  - 实现位置信息记录功能
  - 实现 get_posting_list 方法
  - 实现 get_term_frequency 和 get_vocabulary_size 方法
  - _需求：3.1, 3.2, 3.3, 3.4_

- [ ]* 4.1 编写 InvertedIndex 的属性测试
  - **属性 6：词项完整性**
  - **验证需求：3.1, 3.4**

- [ ]* 4.2 编写 InvertedIndex 的属性测试
  - **属性 7：位置信息准确性**
  - **验证需求：3.3**

- [ ]* 4.3 编写 InvertedIndex 的属性测试
  - **属性 8：索引往返一致性**
  - **验证需求：3.5**

- [x] 5. 实现查询处理组件
  - 实现 QueryProcessor 类的基本结构
  - 实现单词项查询功能（search 方法）
  - 实现查询词预处理（使用 TextPreprocessor）
  - 实现查询结果排序
  - 处理不存在词项的查询（返回空列表）
  - _需求：4.1, 4.2, 4.3, 4.4_

- [ ]* 5.1 编写 QueryProcessor 的属性测试
  - **属性 9：查询结果完整性**
  - **验证需求：4.1**

- [ ]* 5.2 编写 QueryProcessor 的属性测试
  - **属性 10：查询预处理一致性**
  - **验证需求：4.3**

- [ ]* 5.3 编写 QueryProcessor 的属性测试
  - **属性 11：结果排序性**
  - **验证需求：4.4**

- [x] 6. 实现布尔查询功能
  - 实现 and_query 方法（交集运算）
  - 实现 or_query 方法（并集运算）
  - 实现 not_query 方法（差集运算）
  - 实现 boolean_search 方法，解析布尔查询字符串
  - 实现运算符优先级处理（NOT > AND > OR）
  - _需求：5.1, 5.2, 5.3, 5.4_

- [ ]* 6.1 编写布尔查询的属性测试
  - **属性 12：AND 运算正确性**
  - **验证需求：5.1**

- [ ]* 6.2 编写布尔查询的属性测试
  - **属性 13：OR 运算正确性**
  - **验证需求：5.2**

- [ ]* 6.3 编写布尔查询的属性测试
  - **属性 14：NOT 运算正确性**
  - **验证需求：5.3**

- [ ]* 6.4 编写布尔查询的属性测试
  - **属性 15：布尔运算优先级**
  - **验证需求：5.4**

- [x] 7. 实现索引持久化功能
  - 在 InvertedIndex 中实现 save 方法（使用 pickle）
  - 实现 load 方法，从文件恢复索引
  - 实现文件不存在的错误处理
  - 实现序列化错误处理
  - 确保保存包含所有索引状态（文档、词项、倒排列表）
  - _需求：6.1, 6.2, 6.3, 6.4_

- [ ]* 7.1 编写持久化的属性测试
  - **属性 16：序列化往返一致性**
  - **验证需求：6.3**

- [ ]* 7.2 编写持久化的单元测试
  - 测试加载不存在的文件
  - **属性 17：文件操作健壮性**
  - **验证需求：6.4**

- [x] 8. 实现统计信息功能
  - 实现 get_statistics 方法返回 IndexStatistics
  - 实现文档总数统计
  - 实现唯一词项数统计
  - 实现词项文档频率查询
  - 实现平均文档长度计算
  - _需求：7.1, 7.2, 7.3, 7.4_

- [ ]* 8.1 编写统计信息的属性测试
  - **属性 18：文档计数准确性**
  - **验证需求：7.1**

- [ ]* 8.2 编写统计信息的属性测试
  - **属性 19：词汇表大小准确性**
  - **验证需求：7.2**

- [ ]* 8.3 编写统计信息的属性测试
  - **属性 20：词频统计准确性**
  - **验证需求：7.3**

- [ ]* 8.4 编写统计信息的属性测试
  - **属性 21：平均文档长度准确性**
  - **验证需求：7.4**

- [-] 9. 实现 IndexSystem 主入口类
  - 实现 IndexSystem 类，集成所有组件
  - 实现 add_document 方法，协调文档存储和索引构建
  - 实现 search 和 boolean_search 方法
  - 实现 get_statistics 方法
  - 实现 save_index 和 load_index 方法
  - 添加适当的错误处理和日志记录
  - _需求：所有需求_

- [ ] 10. 创建示例程序和文档
  - 创建 demo.py 演示程序
  - 实现交互式命令行界面
  - 准备示例文档数据
  - 编写 README.md 使用说明
  - 添加代码注释和文档字符串
  - _需求：所有需求_

- [ ] 11. 最终检查点
  - 确保所有测试通过，如有问题请询问用户
